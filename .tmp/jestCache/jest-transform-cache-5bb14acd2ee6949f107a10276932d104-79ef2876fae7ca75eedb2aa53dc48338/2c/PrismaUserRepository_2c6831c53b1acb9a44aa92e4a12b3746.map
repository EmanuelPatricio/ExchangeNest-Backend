{"file":"C:\\Users\\epatr\\projects\\ExchangeNest-Backend\\src\\Contexts\\PIE\\Users\\infrastructure\\persistence\\PrismaUserRepository.ts","mappings":";;;;;;;;;;;;AACA,qIAAqH;AACrH,4CAAyC;AACzC,gEAA6D;AAE7D,sDAAmD;AACnD,4DAAyD;AACzD,8DAA2D;AAC3D,4DAAyD;AACzD,kDAA+C;AAC/C,8DAA2D;AAC3D,sDAAmD;AAEnD,MAAa,oBAAoB;IAClB,IAAI,CAAC,IAAU;;;YAC1B,MAAM,4BAAM,CAAC,KAAK,CAAC,MAAM,CAAC;gBACxB,IAAI,EAAE;oBACJ,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK;oBACjB,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK;oBAChC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;oBAC9B,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK;oBACnB,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK;oBACvB,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;oBAC7B,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK;oBAChC,UAAU,EAAE,CAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,KAAK,KAAI,IAAI;oBACzC,OAAO,EAAE,IAAI,CAAC,MAAM;oBACpB,cAAc,EAAE,IAAI,CAAC,YAAY;oBACjC,UAAU,EAAE,IAAI,CAAC,SAAS;oBAC1B,UAAU,EAAE,IAAI,CAAC,SAAS;oBAC1B,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK;oBAChC,gBAAgB,EAAE,IAAI,CAAC,cAAc,IAAI,IAAI;oBAC7C,gBAAgB,EAAE,IAAI,CAAC,cAAc,IAAI,IAAI;iBAC9C;aACF,CAAC,CAAA;;KACH;IAEY,KAAK,CAAC,KAAgB,EAAE,QAAsB;;YACzD,MAAM,IAAI,GAAG,MAAM,4BAAM,CAAC,KAAK,CAAC,SAAS,CAAC;gBACxC,KAAK,EAAE;oBACL,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,QAAQ,EAAE,QAAQ,CAAC,KAAK;iBACzB;aACF,CAAC,CAAC;YAEH,OAAO,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,WAAI,CAC7B,IAAI,eAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EACnB,IAAI,6BAAa,CAAC,IAAI,CAAC,UAAU,CAAC,EAClC,IAAI,2BAAY,CAAC,IAAI,CAAC,SAAS,CAAC,EAChC,IAAI,iBAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EACrB,IAAI,qBAAS,CAAC,IAAI,CAAC,KAAK,CAAC,EACzB,IAAI,2BAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,EAC/B,IAAI,6BAAa,CAAC,IAAI,CAAC,UAAU,CAAC,EAClC,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,qBAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,EAChE,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,UAAU,EACf,IAAI,eAAM,CAAC,IAAI,CAAC,UAAU,CAAC,EAC3B,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,gBAAgB,CACtB,CAAC,CAAC,CAAC,IAAI,CAAC;QACX,CAAC;KAAA;CACF;AAjDD,oDAiDC","names":[],"sources":["C:\\Users\\epatr\\projects\\ExchangeNest-Backend\\src\\Contexts\\PIE\\Users\\infrastructure\\persistence\\PrismaUserRepository.ts"],"sourcesContent":["import { Nullable } from '../../../../Shared/domain/Nullable';\r\nimport { prisma } from '../../../../../../src/Contexts/Shared/infrastructure/persistence/prisma/PrismaClientFactory';\r\nimport { User } from '../../domain/User';\r\nimport { UserId } from '../../../Shared/domain/Users/UserId';\r\nimport { UserRepository } from '../../domain/UserRepository';\r\nimport { UserEmail } from '../../domain/UserEmail';\r\nimport { UserPassword } from '../../domain/UserPassword';\r\nimport { UserFirstName } from '../../domain/UserFirstName';\r\nimport { UserLastName } from '../../domain/UserLastName';\r\nimport { UserNIC } from '../../domain/UserNIC';\r\nimport { UserBirthDate } from '../../domain/UserBirthDate';\r\nimport { UserImage } from '../../domain/UserImage';\r\n\r\nexport class PrismaUserRepository implements UserRepository {\r\n  public async save(user: User): Promise<void> {\r\n    await prisma.users.create({\r\n      data: {\r\n        id: user.id.value,\r\n        first_name: user.firstName.value,\r\n        last_name: user.lastName.value,\r\n        nic: user.nic.value,\r\n        email: user.email.value,\r\n        password: user.password.value,\r\n        birth_date: user.birthDate.value,\r\n        user_image: user.userImage?.value || null,\r\n        id_role: user.idRole,\r\n        id_user_status: user.idUserStatus,\r\n        id_country: user.idCountry,\r\n        created_on: user.createdOn,\r\n        created_by: user.createdBy.value,\r\n        last_modified_on: user.lastModifiedOn || null,\r\n        last_modified_by: user.lastModifiedBy || null\r\n      }\r\n    })\r\n  }\r\n\r\n  public async login(email: UserEmail, password: UserPassword): Promise<Nullable<User>> {\r\n    const user = await prisma.users.findFirst({\r\n      where: {\r\n        email: email.value,\r\n        password: password.value\r\n      }\r\n    });\r\n\r\n    return user !== null ? new User(\r\n      new UserId(user.id),\r\n      new UserFirstName(user.first_name),\r\n      new UserLastName(user.last_name),\r\n      new UserNIC(user.nic),\r\n      new UserEmail(user.email),\r\n      new UserPassword(user.password),\r\n      new UserBirthDate(user.birth_date),\r\n      user.user_image !== null ? new UserImage(user.user_image) : null,\r\n      user.id_role,\r\n      user.id_user_status,\r\n      user.id_country,\r\n      user.created_on,\r\n      new UserId(user.created_by),\r\n      user.last_modified_on,\r\n      user.last_modified_by\r\n    ) : null;\r\n  }\r\n}"],"version":3}