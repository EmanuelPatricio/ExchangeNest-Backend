466a841e97dc165ab83699d3c8751ed0
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const UserCreator_1 = require("../../../../../src/Contexts/PIE/Users/application/UserCreator");
const UserMother_1 = require("../../../PIE/Users/domain/UserMother");
const UserFirstLastNameLengthExceeded_1 = require("../../../../../src/Contexts/PIE/Users/domain/UserFirstLastNameLengthExceeded");
const UserRepositoryMock_1 = require("../__mocks__/UserRepositoryMock");
const CreateUserRequestMother_1 = require("./CreateUserRequestMother");
let repository;
let creator;
beforeEach(() => {
    repository = new UserRepositoryMock_1.UserRepositoryMock();
    creator = new UserCreator_1.UserCreator(repository);
});
describe('UserCreator', () => {
    it('should create a valid user', () => __awaiter(void 0, void 0, void 0, function* () {
        const request = CreateUserRequestMother_1.CreateUserRequestMother.random();
        yield creator.run(request);
        const user = UserMother_1.UserMother.fromRequest(request);
        repository.assertSaveHaveBeenCalledWith(user);
    }));
    it('should throw error if user first name length is exceeded', () => __awaiter(void 0, void 0, void 0, function* () {
        expect(() => {
            const request = CreateUserRequestMother_1.CreateUserRequestMother.invalidRequest();
            const user = UserMother_1.UserMother.fromRequest(request);
            creator.run(request);
            repository.assertSaveHaveBeenCalledWith(user);
        }).toThrow(UserFirstLastNameLengthExceeded_1.UserFirstLastNameLengthExceeded);
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxlcGF0clxccHJvamVjdHNcXEV4Y2hhbmdlTmVzdC1CYWNrZW5kXFx0ZXN0c1xcQ29udGV4dHNcXFBJRVxcVXNlcnNcXGFwcGxpY2F0aW9uXFxVc2VyQ3JlYXRvci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsK0ZBQTJGO0FBQzNGLHFFQUFpRTtBQUNqRSxrSUFBOEg7QUFDOUgsd0VBQW9FO0FBQ3BFLHVFQUFtRTtBQUVuRSxJQUFJLFVBQThCLENBQUE7QUFDbEMsSUFBSSxPQUFvQixDQUFBO0FBRXhCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7SUFDZCxVQUFVLEdBQUcsSUFBSSx1Q0FBa0IsRUFBRSxDQUFBO0lBQ3JDLE9BQU8sR0FBRyxJQUFJLHlCQUFXLENBQUMsVUFBVSxDQUFDLENBQUE7QUFDdkMsQ0FBQyxDQUFDLENBQUE7QUFFRixRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtJQUMzQixFQUFFLENBQUMsNEJBQTRCLEVBQUUsR0FBUyxFQUFFO1FBQzFDLE1BQU0sT0FBTyxHQUFHLGlEQUF1QixDQUFDLE1BQU0sRUFBRSxDQUFBO1FBRWhELE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUUxQixNQUFNLElBQUksR0FBRyx1QkFBVSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUU1QyxVQUFVLENBQUMsNEJBQTRCLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDL0MsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQywwREFBMEQsRUFBRSxHQUFTLEVBQUU7UUFDeEUsTUFBTSxDQUFDLEdBQUcsRUFBRTtZQUNWLE1BQU0sT0FBTyxHQUFHLGlEQUF1QixDQUFDLGNBQWMsRUFBRSxDQUFBO1lBRXhELE1BQU0sSUFBSSxHQUFHLHVCQUFVLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBRTVDLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUE7WUFFcEIsVUFBVSxDQUFDLDRCQUE0QixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxpRUFBK0IsQ0FBQyxDQUFDO0lBQzlDLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGVwYXRyXFxwcm9qZWN0c1xcRXhjaGFuZ2VOZXN0LUJhY2tlbmRcXHRlc3RzXFxDb250ZXh0c1xcUElFXFxVc2Vyc1xcYXBwbGljYXRpb25cXFVzZXJDcmVhdG9yLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVXNlckNyZWF0b3IgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zcmMvQ29udGV4dHMvUElFL1VzZXJzL2FwcGxpY2F0aW9uL1VzZXJDcmVhdG9yJ1xyXG5pbXBvcnQgeyBVc2VyTW90aGVyIH0gZnJvbSAnLi4vLi4vLi4vUElFL1VzZXJzL2RvbWFpbi9Vc2VyTW90aGVyJ1xyXG5pbXBvcnQgeyBVc2VyRmlyc3RMYXN0TmFtZUxlbmd0aEV4Y2VlZGVkIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc3JjL0NvbnRleHRzL1BJRS9Vc2Vycy9kb21haW4vVXNlckZpcnN0TGFzdE5hbWVMZW5ndGhFeGNlZWRlZCdcclxuaW1wb3J0IHsgVXNlclJlcG9zaXRvcnlNb2NrIH0gZnJvbSAnLi4vX19tb2Nrc19fL1VzZXJSZXBvc2l0b3J5TW9jaydcclxuaW1wb3J0IHsgQ3JlYXRlVXNlclJlcXVlc3RNb3RoZXIgfSBmcm9tICcuL0NyZWF0ZVVzZXJSZXF1ZXN0TW90aGVyJ1xyXG5cclxubGV0IHJlcG9zaXRvcnk6IFVzZXJSZXBvc2l0b3J5TW9ja1xyXG5sZXQgY3JlYXRvcjogVXNlckNyZWF0b3JcclxuXHJcbmJlZm9yZUVhY2goKCkgPT4ge1xyXG4gIHJlcG9zaXRvcnkgPSBuZXcgVXNlclJlcG9zaXRvcnlNb2NrKClcclxuICBjcmVhdG9yID0gbmV3IFVzZXJDcmVhdG9yKHJlcG9zaXRvcnkpXHJcbn0pXHJcblxyXG5kZXNjcmliZSgnVXNlckNyZWF0b3InLCAoKSA9PiB7XHJcbiAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCB1c2VyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IENyZWF0ZVVzZXJSZXF1ZXN0TW90aGVyLnJhbmRvbSgpXHJcblxyXG4gICAgYXdhaXQgY3JlYXRvci5ydW4ocmVxdWVzdClcclxuXHJcbiAgICBjb25zdCB1c2VyID0gVXNlck1vdGhlci5mcm9tUmVxdWVzdChyZXF1ZXN0KVxyXG5cclxuICAgIHJlcG9zaXRvcnkuYXNzZXJ0U2F2ZUhhdmVCZWVuQ2FsbGVkV2l0aCh1c2VyKVxyXG4gIH0pO1xyXG5cclxuICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGlmIHVzZXIgZmlyc3QgbmFtZSBsZW5ndGggaXMgZXhjZWVkZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBleHBlY3QoKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gQ3JlYXRlVXNlclJlcXVlc3RNb3RoZXIuaW52YWxpZFJlcXVlc3QoKVxyXG5cclxuICAgICAgY29uc3QgdXNlciA9IFVzZXJNb3RoZXIuZnJvbVJlcXVlc3QocmVxdWVzdClcclxuXHJcbiAgICAgIGNyZWF0b3IucnVuKHJlcXVlc3QpXHJcblxyXG4gICAgICByZXBvc2l0b3J5LmFzc2VydFNhdmVIYXZlQmVlbkNhbGxlZFdpdGgodXNlcik7XHJcbiAgICB9KS50b1Rocm93KFVzZXJGaXJzdExhc3ROYW1lTGVuZ3RoRXhjZWVkZWQpO1xyXG4gIH0pO1xyXG59KTsiXSwidmVyc2lvbiI6M30=